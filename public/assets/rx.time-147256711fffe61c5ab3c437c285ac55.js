!function(n,e){var t="object"==typeof exports&&exports&&("object"==typeof n&&n&&n==n.global&&(window=n),exports);"function"==typeof define&&define.amd?define(["rx","exports"],function(t,r){return n.Rx=e(n,r,t),n.Rx}):"object"==typeof module&&module&&module.exports==t?module.exports=e(n,module.exports,require("./rx")):n.Rx=e(n,{},n.Rx)}(this,function(n,e,t,r){function o(n,e){return new b(function(t){return e.scheduleWithAbsolute(n,function(){t.onNext(0),t.onCompleted()})})}function i(n,e,t){var r=T(e);return new b(function(e){var o=0,i=n;return t.scheduleRecursiveWithAbsolute(i,function(n){var u;r>0&&(u=t.now(),i+=r,u>=i&&(i=u+r)),e.onNext(o++),n(i)})})}function u(n,e){var t=T(n);return new b(function(n){return e.scheduleWithRelative(t,function(){n.onNext(0),n.onCompleted()})})}function s(n,e,t){return n===e?new b(function(n){return t.schedulePeriodicWithState(0,e,function(e){return n.onNext(e),e+1})}):h(function(){return i(t.now()+n,e,t)})}function c(n,e){var t=this;return new b(function(r){var o,i=!1,u=new W,s=null,c=[],a=!1;return o=t.materialize().timestamp(e).subscribe(function(t){var o,f;"E"===t.value.kind?(c=[],c.push(t),s=t.value.exception,f=!a):(c.push({value:t.value,timestamp:t.timestamp+n}),f=!i,i=!0),f&&(null!==s?r.onError(s):(o=new x,u.disposable(o),o.disposable(e.scheduleRecursiveWithRelative(n,function(n){var t,o,u,f;if(null===s){a=!0;do u=null,c.length>0&&c[0].timestamp-e.now()<=0&&(u=c.shift().value),null!==u&&u.accept(r);while(null!==u);f=!1,o=0,c.length>0?(f=!0,o=Math.max(0,c[0].timestamp-e.now())):i=!1,t=s,a=!1,null!==t?r.onError(t):f&&n(o)}}))))}),new y(o,u)})}function a(n,e){var t=this;return h(function(){var r=n-e.now();return c.call(t,r,e)})}function f(n,e){return new b(function(t){function r(){u&&(u=!1,t.onNext(i)),o&&t.onCompleted()}var o,i,u;return new y(n.subscribe(function(n){u=!0,i=n},t.onError.bind(t),function(){o=!0}),e.subscribe(r,t.onError.bind(t),r))})}var l=t.Observable,v=l.prototype,b=t.Internals.AnonymousObservable,h=l.defer,d=l.empty,p=l.throwException,w=l.fromArray,m=t.Scheduler.timeout,x=t.SingleAssignmentDisposable,W=t.SerialDisposable,y=t.CompositeDisposable,E=t.RefCountDisposable,N=t.Subject,C=(t.Internals.BinaryObserver,t.Internals.addRef),T=t.Scheduler.normalize,R=l.interval=function(n,e){return e||(e=m),s(n,n,e)},D=l.timer=function(n,e,t){var c;return t||(t=m),e!==r&&"number"==typeof e?c=e:e!==r&&"object"==typeof e&&(t=e),n instanceof Date&&c===r?o(n.getTime(),t):n instanceof Date&&c!==r?(c=e,i(n.getTime(),c,t)):c===r?u(n,t):s(n,c,t)};return v.delay=function(n,e){return e||(e=m),n instanceof Date?a.call(this,n.getTime(),e):c.call(this,n,e)},v.throttle=function(n,e){e||(e=m);var t=this;return new b(function(r){var o,i=new W,u=!1,s=0,c=null;return o=t.subscribe(function(t){var o,a;u=!0,c=t,s++,o=s,a=new x,i.disposable(a),a.disposable(e.scheduleWithRelative(n,function(){u&&s===o&&r.onNext(c),u=!1}))},function(n){i.dispose(),r.onError(n),u=!1,s++},function(){i.dispose(),u&&r.onNext(c),r.onCompleted(),u=!1,s++}),new y(o,i)})},v.windowWithTime=function(n,e,t){var o,i=this;return e===r&&(o=n),t===r&&(t=m),"number"==typeof e?o=e:"object"==typeof e&&(o=n,t=e),new b(function(e){var r,u,s,c=o,a=n,f=[],l=new W,v=0;return u=new y(l),s=new E(u),r=function(){var n,i,u,b,h;u=new x,l.disposable(u),i=!1,n=!1,a===c?(i=!0,n=!0):c>a?i=!0:n=!0,b=i?a:c,h=b-v,v=b,i&&(a+=o),n&&(c+=o),u.disposable(t.scheduleWithRelative(h,function(){var t;n&&(t=new N,f.push(t),e.onNext(C(t,s))),i&&(t=f.shift(),t.onCompleted()),r()}))},f.push(new N),e.onNext(C(f[0],s)),r(),u.add(i.subscribe(function(n){var e,t;for(e=0;e<f.length;e++)t=f[e],t.onNext(n)},function(n){var t,r;for(t=0;t<f.length;t++)r=f[t],r.onError(n);e.onError(n)},function(){var n,t;for(n=0;n<f.length;n++)t=f[n],t.onCompleted();e.onCompleted()})),s})},v.windowWithTimeOrCount=function(n,e,t){var r=this;return t||(t=m),new b(function(o){var i,u,s,c,a=0,f=new W,l=0;return u=new y(f),s=new E(u),i=function(e){var r=new x;f.disposable(r),r.disposable(t.scheduleWithRelative(n,function(){var n;e===l&&(a=0,n=++l,c.onCompleted(),c=new N,o.onNext(C(c,s)),i(n))}))},c=new N,o.onNext(C(c,s)),i(0),u.add(r.subscribe(function(n){var t=0,r=!1;c.onNext(n),a++,a===e&&(r=!0,a=0,t=++l,c.onCompleted(),c=new N,o.onNext(C(c,s))),r&&i(t)},function(n){c.onError(n),o.onError(n)},function(){c.onCompleted(),o.onCompleted()})),s})},v.bufferWithTime=function(n,e,t){var o;return e===r&&(o=n),t||(t=m),"number"==typeof e?o=e:"object"==typeof e&&(o=n,t=e),this.windowWithTime(n,o,t).selectMany(function(n){return n.toArray()})},v.bufferWithTimeOrCount=function(n,e,t){return t||(t=m),this.windowWithTimeOrCount(n,e,t).selectMany(function(n){return n.toArray()})},v.timeInterval=function(n){var e=this;return n||(n=m),h(function(){var t=n.now();return e.select(function(e){var r=n.now(),o=r-t;return t=r,{value:e,interval:o}})})},v.timestamp=function(n){return n||(n=m),this.select(function(e){return{value:e,timestamp:n.now()}})},v.sample=function(n,e){return e||(e=m),"number"==typeof n?f(this,R(n,e)):f(this,n)},v.timeout=function(n,e,t){var r,o=this;return e||(e=p(new Error("Timeout"))),t||(t=m),r=n instanceof Date?function(n,e){t.scheduleWithAbsolute(n,e)}:function(n,e){t.scheduleWithRelative(n,e)},new b(function(t){var i,u=0,s=new x,c=new W,a=!1,f=new W;return c.disposable(s),i=function(){var o=u;f.disposable(r(n,function(){a=u===o;var n=a;n&&c.disposable(e.subscribe(t))}))},i(),s.disposable(o.subscribe(function(n){var e=!a;e&&(u++,t.onNext(n),i())},function(n){var e=!a;e&&(u++,t.onError(n))},function(){var n=!a;n&&(u++,t.onCompleted())})),new y(c,f)})},l.generateWithAbsoluteTime=function(n,e,t,r,o,i){return i||(i=m),new b(function(u){var s,c,a=!0,f=!1,l=n;return i.scheduleRecursiveWithAbsolute(i.now(),function(n){f&&u.onNext(s);try{a?a=!1:l=t(l),f=e(l),f&&(s=r(l),c=o(l))}catch(i){return u.onError(i),void 0}f?n(c):u.onCompleted()})})},l.generateWithRelativeTime=function(n,e,t,r,o,i){return i||(i=m),new b(function(u){var s,c,a=!0,f=!1,l=n;return i.scheduleRecursiveWithRelative(0,function(n){f&&u.onNext(s);try{a?a=!1:l=t(l),f=e(l),f&&(s=r(l),c=o(l))}catch(i){return u.onError(i),void 0}f?n(c):u.onCompleted()})})},v.delaySubscription=function(n,e){return e||(e=m),this.delayWithSelector(D(n,e),function(){return d()})},v.delayWithSelector=function(n,e){var t,r,o=this;return"function"==typeof n?r=n:(t=n,r=e),new b(function(n){var e=new y,i=!1,u=function(){i&&0===e.length&&n.onCompleted()},s=new W,c=function(){s.setDisposable(o.subscribe(function(t){var o;try{o=r(t)}catch(i){return n.onError(i),void 0}var s=new x;e.add(s),s.setDisposable(o.subscribe(function(){n.onNext(t),e.remove(s),u()},n.onError.bind(n),function(){n.onNext(t),e.remove(s),u()}))},n.onError.bind(n),function(){i=!0,s.dispose(),u()}))};return t?s.setDisposable(t.subscribe(function(){c()},n.onError.bind(n),function(){c()})):c(),new y(s,e)})},v.timeoutWithSelector=function(n,e,t){n||(n=observableNever()),t||(t=p(new Error("Timeout")));var r=this;return new b(function(o){var i=new W,u=new W,s=new x;i.setDisposable(s);var c=0,a=!1,f=function(n){var e=c,r=function(){return c===e},s=new x;u.setDisposable(s),s.setDisposable(n.subscribe(function(){r()&&i.setDisposable(t.subscribe(o)),s.dispose()},function(n){r()&&o.onError(n)},function(){r()&&i.setDisposable(t.subscribe(o))}))};f(n);var l=function(){var n=!a;return n&&c++,n};return s.setDisposable(r.subscribe(function(n){if(l()){o.onNext(n);var t;try{t=e(n)}catch(r){return o.onError(r),void 0}f(t)}},function(n){l()&&o.onError(n)},function(){l()&&o.onCompleted()})),new y(i,u)})},v.throttleWithSelector=function(n){var e=this;return new b(function(t){var r,o=!1,i=new W,u=0,s=e.subscribe(function(e){var s;try{s=n(e)}catch(c){return t.onError(c),void 0}o=!0,r=e,u++;var a=u,f=new x;i.setDisposable(f),f.setDisposable(s.subscribe(function(){o&&u===a&&t.onNext(r),o=!1,f.dispose()},t.onError.bind(t),function(){o&&u===a&&t.onNext(r),o=!1,f.dispose()}))},function(n){i.dispose(),t.onError(n),o=!1,u++},function(){i.dispose(),o&&t.onNext(r),t.onCompleted(),o=!1,u++});return new y(s,i)})},v.skipLastWithTime=function(n,e){e||(e=m);var t=this;return new b(function(r){var o=[];return t.subscribe(function(t){var i=e.now();for(o.push({interval:i,value:t});o.length>0&&i-o[0].interval>=n;)r.onNext(o.shift().value)},r.onError.bind(r),function(){for(var t=e.now();o.length>0&&t-o[0].interval>=n;)r.onNext(o.shift().value);r.onCompleted()})})},v.takeLastWithTime=function(n,e,t){return this.takeLastBufferWithTime(n,e).selectMany(function(n){return w(n,t)})},v.takeLastBufferWithTime=function(n,e){var t=this;return e||(e=m),new b(function(r){var o=[];return t.subscribe(function(t){var r=e.now();for(o.push({interval:r,value:t});o.length>0&&r-o[0].interval>=n;)o.shift()},r.onError.bind(r),function(){for(var t=e.now(),i=[];o.length>0;){var u=o.shift();t-u.interval<=n&&i.push(u.value)}r.onNext(i),r.onCompleted()})})},v.takeWithTime=function(n,e){var t=this;return e||(e=m),new b(function(r){var o=e.scheduleWithRelative(n,function(){r.onCompleted()});return new y(o,t.subscribe(r))})},v.skipWithTime=function(n,e){var t=this;return e||(e=m),new b(function(r){var o=!1,i=e.scheduleWithRelative(n,function(){o=!0}),u=t.subscribe(function(n){o&&r.onNext(n)},r.onError.bind(r),r.onCompleted.bind(r));return new y(i,u)})},v.skipUntilWithTime=function(n,e){e||(e=m);var t=this;return new b(function(r){var o=!1,i=e.scheduleWithAbsolute(n,function(){o=!0}),u=t.subscribe(function(n){o&&r.onNext(n)},r.onError.bind(r),r.onCompleted.bind(r));return new y(i,u)})},v.takeUntilWithTime=function(n,e){e||(e=m);var t=this;return new b(function(r){return new y(e.scheduleWithAbsolute(n,function(){r.onCompleted()}),t.subscribe(r))})},t});