!function(t){"use strict";var n=t.module("Devise",[]);n.factory("deviseInterceptor401",["$rootScope","$q",function(t,n){return{responseError:function(r){if(401===r.status&&!r.config.ignoreAuth){var e=n.defer();return t.$broadcast("devise:unauthorized",r,e),e.promise}return n.reject(r)}}}]).config(["$httpProvider",function(t){t.interceptors.push("deviseInterceptor401")}]),n.provider("Auth",function(){function n(t,n){var r={method:u[t].toLowerCase(),url:o[t],ignoreAuth:i};return n&&(r.data=n),console.log(r),r}function r(n,r){t.forEach(n,function(t,e){this[e+r]=function(t){return void 0===t?n[e]:(n[e]=t,this)}},this)}function e(t){return function(){return t}}var o={login:"/users/sign_in.json",logout:"/users/sign_out.json",register:"/users.json"},u={login:"POST",logout:"DELETE",register:"POST"},i=!1,s=function(t){return t.data};r.call(this,u,"Method"),r.call(this,o,"Path"),this.ignoreAuth=function(t){return void 0===t?i:(i=!!t,this)},this.parse=function(t){return"function"!=typeof t?s:(s=t,this)},this.$get=["$q","$http","$rootScope",function(t,r,o){function u(t){return h._currentUser=t,t}function i(){u(null)}function c(t){return function(n){return o.$broadcast("devise:"+t,n),n}}var h={_currentUser:null,parse:s,login:function(t){var e=arguments.length>0,o=h.isAuthenticated();return t=t||{},r(n("login",{user:t})).then(h.parse).then(u).then(function(t){return e&&!o?c("new-session")(t):t}).then(c("login"))},logout:function(){var t=e(h._currentUser);return r(n("logout")).then(i).then(t).then(c("logout"))},register:function(t){return t=t||{},r(n("register",{user:t})).then(h.parse).then(u).then(c("new-registration"))},currentUser:function(){return h.isAuthenticated()?t.when(h._currentUser):h.login()},isAuthenticated:function(){return!!h._currentUser&&!!h._currentUser.email}};return h}]})}(angular);